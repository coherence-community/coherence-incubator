<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2014-06-23
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20140623" />
    <meta http-equiv="Content-Language" content="en" />
    <title>The Oracle Coherence Incubator - </title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

                          
        
<link rel="shortcut icon" href="images/incubator-logo.ico"/>
                      
        
<script src="js/site.js" type="text/javascript"></script>
                      
        
<script type="text/javascript">var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-39051314-1']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();</script>
          
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/coherence-community/coherence-incubator/">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Coherence Incubator Site</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2014-06-23</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 12.2.1-SNAPSHOT</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Oracle Coherence Incubator</li>
                                
      <li>
    
                          <a href="../index.html" title="Welcome">
          <i class="none"></i>
        Welcome</a>
            </li>
                  
      <li>
    
                          <a href="../history.html" title="Change History">
          <i class="none"></i>
        Change History</a>
            </li>
                  
      <li>
    
                          <a href="../upgrading.html" title="Upgrading">
          <i class="none"></i>
        Upgrading</a>
            </li>
                  
      <li>
    
                          <a href="../examples.html" title="Examples">
          <i class="none"></i>
        Examples</a>
            </li>
                  
      <li>
    
                          <a href="../support.html" title="Getting Help">
          <i class="none"></i>
        Getting Help</a>
            </li>
                              <li class="nav-header">Development</li>
                                
      <li>
    
                          <a href="../license.html" title="License">
          <i class="none"></i>
        License</a>
            </li>
                  
      <li>
    
                          <a href="../release-numbers.html" title="Release Numbers">
          <i class="none"></i>
        Release Numbers</a>
            </li>
                  
      <li>
    
                          <a href="../source-code.html" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                  
      <li>
    
                          <a href="../building.html" title="Build Instructions">
          <i class="none"></i>
        Build Instructions</a>
            </li>
                  
      <li>
    
                          <a href="../issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                  
      <li>
    
                          <a href="../contributions.html" title="Contributions">
          <i class="none"></i>
        Contributions</a>
            </li>
                  
      <li>
    
                          <a href="../logging.html" title="Logging">
          <i class="none"></i>
        Logging</a>
            </li>
                              <li class="nav-header">Plug-Ins</li>
                                
      <li>
    
                          <a href="../jvisualvm/index.html" title="The JVisualVM Plug-In">
          <i class="none"></i>
        The JVisualVM Plug-In</a>
            </li>
                              <li class="nav-header">Modules</li>
                                                                                                                                  
      <li>
    
                          <a href="../common/index.html" title="The Common Package">
          <i class="icon-chevron-down"></i>
        The Common Package</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../common/element-namespace.html" title="The Element Namespace">
          <i class="none"></i>
        The Element Namespace</a>
            </li>
                      
      <li>
    
                          <a href="../common/filter-namespace.html" title="The Filter Namespace">
          <i class="none"></i>
        The Filter Namespace</a>
            </li>
                      
      <li>
    
                          <a href="../common/jndi-namespace.html" title="The JNDI Namespace">
          <i class="none"></i>
        The JNDI Namespace</a>
            </li>
                      
      <li>
    
                          <a href="../common/amazon-ec2-addressprovider.html" title="Working with Amazon EC2">
          <i class="none"></i>
        Working with Amazon EC2</a>
            </li>
              </ul>
        </li>
                                                              
      <li>
    
                          <a href="../commandpattern/index.html" title="The Command Pattern">
          <i class="icon-chevron-down"></i>
        The Command Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../commandpattern/simple-example.html" title="Simple Example">
          <i class="none"></i>
        Simple Example</a>
            </li>
              </ul>
        </li>
                                                              
      <li>
    
                          <a href="../functorpattern/index.html" title="The Functor Pattern">
          <i class="icon-chevron-down"></i>
        The Functor Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../functorpattern/simple-example.html" title="Simple Example">
          <i class="none"></i>
        Simple Example</a>
            </li>
              </ul>
        </li>
                                                                                                                                                        
      <li>
    
                          <a href="../processingpattern/index.html" title="The Processing Pattern">
          <i class="icon-chevron-down"></i>
        The Processing Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../processingpattern/configuration.html" title="Configuration">
          <i class="none"></i>
        Configuration</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/monitoring.html" title="Monitoring">
          <i class="none"></i>
        Monitoring</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/processing-namespace.html" title="The Processing Namespace">
          <i class="none"></i>
        The Processing Namespace</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/simple-example.html" title="Simple Example">
          <i class="none"></i>
        Simple Example</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/pi-calculation-example.html" title="Pi Calculation Example">
          <i class="none"></i>
        Pi Calculation Example</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/task-execution-example.html" title="Task Execution Example">
          <i class="none"></i>
        Task Execution Example</a>
            </li>
              </ul>
        </li>
                  
      <li>
    
                          <a href="../messagingpattern/index.html" title="The Messaging Pattern">
          <i class="none"></i>
        The Messaging Pattern</a>
            </li>
                                                              
      <li>
    
                          <a href="../eventdistributionpattern/index.html" title="The Event Distribution Pattern">
          <i class="icon-chevron-down"></i>
        The Event Distribution Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../eventdistributionpattern/event-namespace.html" title="The Event Namespace">
          <i class="none"></i>
        The Event Namespace</a>
            </li>
              </ul>
        </li>
                                                                                                                                                                  
      <li>
    
                          <a href="../pushreplicationpattern/index.html" title="The Push Replication Pattern">
          <i class="icon-chevron-down"></i>
        The Push Replication Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../pushreplicationpattern/active-passive-tutorial.html" title="Active Passive Tutorial">
          <i class="none"></i>
        Active Passive Tutorial</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/active-passive-example.html" title="Active Passive Example">
          <i class="none"></i>
        Active Passive Example</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/active-active-example.html" title="Active Active Example">
          <i class="none"></i>
        Active Active Example</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/hub-and-spoke-example.html" title="Hub And Spoke Example">
          <i class="none"></i>
        Hub And Spoke Example</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/auction-example.html" title="Auction Example">
          <i class="none"></i>
        Auction Example</a>
            </li>
                      
      <li class="active">
    
            <a href="#"><i class="none"></i>Web Example</a>
          </li>
              </ul>
        </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h2>The Coherence*Web Example</h2>

<h4>Prerequisites</h4>

<p>To run this example the Oracle Coherence Incubator must be built and
installed locally.  Instructions on how to achieve this are located here:
<a href="building.html">Building the Oracle Coherence Incubator</a>.</p>

<h4>Source Code</h4>

<p>The source code for this example is located in the <code>coherence-pushreplicationpattern-web-example</code>
module of the Oracle Coherence Incubator.</p>

<h4>Components</h4>

<h5>Coherence*Web specific classes</h5>

<p>There are two classes added to support Coherence*Web within the Push Replication Pattern:</p>

<ul>
<li>SiteExtractor: EntryExtractor that extracts the site information from a cache entry</li>
<li>SiteSessionExpiryFilterFactory: Coherence*Web filter factory that creates a filter  to only include sessions managed
by the current site when performing session cleanup.</li>
</ul>

<h5>Webapp</h5>

<p>This module contains the simple webapp that modifies a user session and creates a self executing war that will start
Jetty and Coherence for the example. It contains two JSPs:</p>

<ul>
<li>sessionAccess.jsp: Standard JSP (with the <a href="http://docs.oracle.com/cd/E24290_01/coh.371/e22620/cohweb.htm#CIAHGHII">coherence-web-installer</a>
already run against it) that will work with any non WebLogic container. This JSP is used with the example since it runs on Jetty.</li>
<li>sessionAccessSpi: Standard JSP without having the need to be parsed by the coherence-web-installer because of the
WebLogic SPI integration in case you want to deploy the web-app to WebLogic.</li>
</ul>

<h5>Webserver</h5>

<p>This module contains Jetty and custom code that will start Coherence and Jetty from the command line. This module is
shaded into the webapp so that we can have a single sef-executing war file for the example.</p>

<h4>Overview</h4>

<p>This example demonstrates how to combine Coherence*Web with Push Replication to publish HTTP
sessions between data centers.</p>

<p>Coherence*Web uses Coherence partitioned caches to store HTTP session data. The Push Replication
Incubator pattern is an example use of Coherence that provides cache replication between distinct
clusters over TCP via Coherence*Extend. Combining these two technologies results in a compelling topology
for customers that require minimum downtime and user disruption upon the loss of a data center hosting
mission critical web applications.</p>

<p><img src="../images/pushreplicationpattern/web-overview.png" alt="Overview" /></p>

<p>This examples uses two clusters, "Site 1" displayed and "Site 2". In the interest of simplicity of execution, we
have embedded everything that you need to run the example all within the self executing war file. Both sites contain
the same web application and use the same cache configuration. The only differences between them are the settings used
to configure the cluster's identity and ports including:</p>

<ul>
<li>webserver port</li>
<li>cluster port</li>
<li>site name</li>
<li>Extend client port for connecting to the remote site</li>
<li>Extend listen port for the proxy service</li>
</ul>

<p>Site 1 consists of:</p>

<ul>
<li>Webserver running on port 9080 (Connects to the cluster as a storage disabled TCMP client)</li>
<li>Cache server running with a cluster port of 9001</li>
<li>Proxy service listening on port 9002</li>
<li>Client port configured to connect to Site2 at port 10002</li>
</ul>

<p>Site 2 consists of:</p>

<ul>
<li>Webserver running on port 10080 (Connects to the cluster as a storage disabled TCMP client)</li>
<li>Cache server running with a cluster port of 10001</li>
<li>Proxy service listening on port 10002</li>
<li>Client port configured to connect to Site1 at port 9002</li>
</ul>

<h4>Running the Coherence*Web Example</h4>

<blockquote>
  <p>  The following instructions assume that <code>$COHERENCE_INCUBATOR</code> is the directory
    in which the Oracle Coherence Incubator source code has been downloaded,
    unpacked and built according to the prerequisites outlined above.</p>
</blockquote>

<p><img src="../images/pushreplicationpattern/web-example.png" alt="Running" /></p>

<h4>Step 1. Running Site 1</h4>

<p>Execute the following shell commands to start the "Active Server for Site 1".</p>

<p>In a new Terminal / Shell Console for "Site 1"</p>

<ol>
<li><p>Change to the Push Replication Pattern Examples directory.</p>

<p><code>cd $COHERENCE_INCUBATOR/coherence-pushreplicationpattern-web-example/coherence-pushreplicationpattern-web-app/target</code></p></li>
<li><p>Run the "Site 1"</p>

<p><code>java -jar webapp-12.2.1-SNAPSHOT.war site1.properties</code></p></li>
</ol>

<h4>Step 2. Running Site 2</h4>

<p>Execute the following shell commands to start "Site 2".</p>

<p>In a new Terminal / Shell Console for the "Site 2"</p>

<ol>
<li><p>Change to the Push Replication Pattern Coherence*Web Examples directory.</p>

<p><code>cd $COHERENCE_INCUBATOR/coherence-pushreplicationpattern-web-example/coherence-pushreplicationpattern-web-app/target</code></p></li>
<li><p>Run the "Site 2"</p>

<p><code>java -jar coherence-pushreplicationpattern-web-app-12.2.1-SNAPSHOT.war site2.properties</code></p></li>
</ol>

<h4>Step 3. Access Site 1 with the browser and insert some data into the session</h4>

<ol>
<li>Open a browser to the following url: http://localhost:9080/sessionAccess.jsp</li>
<li>Add a session variable to the http session.</li>
</ol>

<p>The application interface should something like the following:</p>

<p><img src="../images/pushreplicationpattern/web-site1.png" alt="Site 1" /></p>

<h4>Step 4. Validate that your session data is visible to Site 2</h4>

<ol>
<li>Navigate the same browser to the following url: http://localhost:10080/sessionAccess.jsp</li>
<li>You should see your same session variables in the web abbplication.</li>
</ol>

<p>The application interface should something like the following:</p>

<p><img src="../images/pushreplicationpattern/web-site2.png" alt="Site 2" /></p>

                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2014.
          All Rights Reserved.      
                    
      </div>

                                                                  <?xml version="1.0" encoding="UTF-8"?>
<div class="copyright">Copyright Â© 2008-2013 Oracle Corporation. All rights reserved.</div>
                                                          <?xml version="1.0" encoding="UTF-8"?>
<div class="version">Version 12.2.1-SNAPSHOT: 2014-06-23 11:29</div>
                  
        
                </div>
    </footer>
  </body>
</html>
