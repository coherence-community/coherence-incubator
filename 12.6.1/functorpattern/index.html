<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2019-05-08
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20190508" />
    <meta http-equiv="Content-Language" content="en" />
    <title>The Oracle Coherence Incubator &#x2013; </title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

                          
        
<link rel="shortcut icon" href="images/incubator-logo.ico"/>
                      
        
<script src="js/site.js" type="text/javascript"></script>
                      
        
<script type="text/javascript">var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-39051314-1']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();</script>
          
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/coherence-community/coherence-incubator/">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Coherence Incubator Site</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2019-05-08</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 12.6.1</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Oracle Coherence Incubator</li>
                                
      <li>
    
                          <a href="../index.html" title="Welcome">
          <i class="none"></i>
        Welcome</a>
            </li>
                  
      <li>
    
                          <a href="../history.html" title="Change History">
          <i class="none"></i>
        Change History</a>
            </li>
                  
      <li>
    
                          <a href="../upgrading.html" title="Upgrading">
          <i class="none"></i>
        Upgrading</a>
            </li>
                  
      <li>
    
                          <a href="../examples.html" title="Examples">
          <i class="none"></i>
        Examples</a>
            </li>
                  
      <li>
    
                          <a href="../support.html" title="Getting Help">
          <i class="none"></i>
        Getting Help</a>
            </li>
                              <li class="nav-header">Development</li>
                                
      <li>
    
                          <a href="../license.html" title="License">
          <i class="none"></i>
        License</a>
            </li>
                  
      <li>
    
                          <a href="../release-numbers.html" title="Release Numbers">
          <i class="none"></i>
        Release Numbers</a>
            </li>
                  
      <li>
    
                          <a href="../source-code.html" title="Source Code">
          <i class="none"></i>
        Source Code</a>
            </li>
                  
      <li>
    
                          <a href="../building.html" title="Build Instructions">
          <i class="none"></i>
        Build Instructions</a>
            </li>
                  
      <li>
    
                          <a href="../issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                  
      <li>
    
                          <a href="../contributions.html" title="Contributions">
          <i class="none"></i>
        Contributions</a>
            </li>
                  
      <li>
    
                          <a href="../logging.html" title="Logging">
          <i class="none"></i>
        Logging</a>
            </li>
                              <li class="nav-header">Plug-Ins</li>
                                
      <li>
    
                          <a href="../jvisualvm/index.html" title="The JVisualVM Plug-In">
          <i class="none"></i>
        The JVisualVM Plug-In</a>
            </li>
                              <li class="nav-header">Modules</li>
                                                                                                                                  
      <li>
    
                          <a href="../common/index.html" title="The Common Package">
          <i class="icon-chevron-down"></i>
        The Common Package</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../common/element-namespace.html" title="The Element Namespace">
          <i class="none"></i>
        The Element Namespace</a>
            </li>
                      
      <li>
    
                          <a href="../common/filter-namespace.html" title="The Filter Namespace">
          <i class="none"></i>
        The Filter Namespace</a>
            </li>
                      
      <li>
    
                          <a href="../common/jndi-namespace.html" title="The JNDI Namespace">
          <i class="none"></i>
        The JNDI Namespace</a>
            </li>
                      
      <li>
    
                          <a href="../common/com.oracle.coherence.cloud.amazon-ec2-addressprovider.html" title="Working with Amazon EC2">
          <i class="none"></i>
        Working with Amazon EC2</a>
            </li>
              </ul>
        </li>
                                                              
      <li>
    
                          <a href="../commandpattern/index.html" title="The Command Pattern">
          <i class="icon-chevron-down"></i>
        The Command Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../commandpattern/simple-example.html" title="Simple Example">
          <i class="none"></i>
        Simple Example</a>
            </li>
              </ul>
        </li>
                                                                  
      <li class="active">
    
            <a href="#"><i class="icon-chevron-down"></i>The Functor Pattern</a>
                  <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../functorpattern/simple-example.html" title="Simple Example">
          <i class="none"></i>
        Simple Example</a>
            </li>
              </ul>
        </li>
                                                                                                                                                        
      <li>
    
                          <a href="../processingpattern/index.html" title="The Processing Pattern">
          <i class="icon-chevron-down"></i>
        The Processing Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../processingpattern/configuration.html" title="Configuration">
          <i class="none"></i>
        Configuration</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/monitoring.html" title="Monitoring">
          <i class="none"></i>
        Monitoring</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/processing-namespace.html" title="The Processing Namespace">
          <i class="none"></i>
        The Processing Namespace</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/simple-example.html" title="Simple Example">
          <i class="none"></i>
        Simple Example</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/pi-calculation-example.html" title="Pi Calculation Example">
          <i class="none"></i>
        Pi Calculation Example</a>
            </li>
                      
      <li>
    
                          <a href="../processingpattern/task-execution-example.html" title="Task Execution Example">
          <i class="none"></i>
        Task Execution Example</a>
            </li>
              </ul>
        </li>
                  
      <li>
    
                          <a href="../messagingpattern/index.html" title="The Messaging Pattern">
          <i class="none"></i>
        The Messaging Pattern</a>
            </li>
                                                              
      <li>
    
                          <a href="../eventdistributionpattern/index.html" title="The Event Distribution Pattern">
          <i class="icon-chevron-down"></i>
        The Event Distribution Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../eventdistributionpattern/event-namespace.html" title="The Event Namespace">
          <i class="none"></i>
        The Event Namespace</a>
            </li>
              </ul>
        </li>
                                                                                                                                                        
      <li>
    
                          <a href="../pushreplicationpattern/index.html" title="The Push Replication Pattern">
          <i class="icon-chevron-down"></i>
        The Push Replication Pattern</a>
                    <ul class="nav nav-list">
                      
      <li>
    
                          <a href="../pushreplicationpattern/active-passive-tutorial.html" title="Active Passive Tutorial">
          <i class="none"></i>
        Active Passive Tutorial</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/active-passive-example.html" title="Active Passive Example">
          <i class="none"></i>
        Active Passive Example</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/active-active-example.html" title="Active Active Example">
          <i class="none"></i>
        Active Active Example</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/hub-and-spoke-example.html" title="Hub And Spoke Example">
          <i class="none"></i>
        Hub And Spoke Example</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/auction-example.html" title="Auction Example">
          <i class="none"></i>
        Auction Example</a>
            </li>
                      
      <li>
    
                          <a href="../pushreplicationpattern/web-example.html" title="Web Example">
          <i class="none"></i>
        Web Example</a>
            </li>
              </ul>
        </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h2>The Functor Pattern</h2>

<h4>Overview</h4>

<p>Provides a distributed implementation of the classic 
<a href="http://en.wikipedia.org/wiki/Function_object">Function Objects (Wikipedia)</a> or 
as it is also known, the Functor Pattern, built using Oracle Coherence.</p>

<h4>Distribution</h4>

<p>The Functor Pattern implementation is distributed in the jar file
called: <code>coherence-functorpattern-12.6.1.jar</code>.</p>

<p>However as the Functor Pattern has several other dependencies, we **strongly
recommend** that developers adopt and use tools like Apache Maven/Ivy/Gradle to
transitively resolve the said dependencies, instead of attempting to do so manually.</p>

<p>To configure your Apache Maven-based application to use the Functor Pattern,
simply add the following declaration to your application <code>pom.xml</code> file
<code>&lt;dependencies&gt;</code> element.</p>

<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.oracle.coherence.incubator&lt;/groupId&gt;
    &lt;artifactId&gt;coherence-functorpattern&lt;/artifactId&gt;
    &lt;version&gt;12.6.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h4>Details</h4>

<p>The Functor Pattern is an extension to the <a href="../commandpattern/index.html">Command Pattern</a>. Naturally this
means the use and semantics of the Functor Pattern are mostly identical to those of the 
Command Pattern, the only difference being that the Functor Pattern provides the
ability to receive returned values (or re-throw exceptions) from submitted requests.  </p>

<p>The mechanism to acquire return values, any exceptions and/or status of execution
is provided through the use of <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Future.html">Java 5+ Futures</a>.</p>

<blockquote>
  <p>  It is highly recommended that you understand the use of the 
    <a href="../commandpattern/index.html">Command Pattern</a> before attempting to use
    the Functor Pattern.  </p>
</blockquote>

<p>As the Functor Pattern provides the ability to acquire return values it's a 
useful alternative to Oracle Coherence <code>EntryProcessors</code> with the advantage that 
<code>Functors</code> are executed asynchronously, instead of synchronously as is the case 
with <code>EntryProcessors</code>. </p>

<h4>Example</h4>

<p>Let's start with a simple example where we use the Functor Pattern to 
asynchronously increment and return the value of a <code>Counter</code>.</p>

<p>First, we'll start by writing a simple <code>Counter</code>.</p>

<pre><code>import java.io.Serializable;
import com.oracle.coherence.patterns.command.Context;

public class Counter implements Context, Serializable {
  private long next;
  public Counter(long initialValue) {
    this.next = initialValue;
  }

  public long next() {
    return next++;
  }

  public String toString() {
    return String.format("Counter{next=%d}", next);
  }
}
</code></pre>

<p>Second, let's write a Functor that will increment the value of a <code>.Counter</code>.</p>

<pre><code>import java.io.Serializable;
import com.oracle.coherence.patterns.command.ExecutionEnvironment;
import com.oracle.coherence.patterns.functor.Functor;

public class NextValueFunctor implements Functor&lt;Counter, Long&gt;, Serializable {
  private static final long serialVersionUID = 4841498972676821911L;

  public Long execute(ExecutionEnvironment&lt;Counter&gt; executionEnvironment) {
    Counter counter = executionEnvironment.getContext();        
    long next = counter.next();
    executionEnvironment.setContext(counter);
    return next;
  }
}
</code></pre>

<p>Lastly, let's write a simple example to test our Functor.</p>

<pre><code>import java.util.concurrent.ExecutionException;
import java.util.concurrent.Future;
import com.oracle.coherence.common.identifiers.Identifier;
import com.oracle.coherence.patterns.command.ContextsManager;
import com.oracle.coherence.patterns.command.DefaultContextsManager;
import com.oracle.coherence.patterns.functor.DefaultFunctorSubmitter;
import com.oracle.coherence.patterns.functor.FunctorSubmitter;
import com.tangosol.net.CacheFactory;

public class FunctorPatternExample {
  public static void main(String[] args) throws InterruptedException, ExecutionException {

    ContextsManager contextsManager = DefaultContextsManager.getInstance();
    Identifier contextIdentifier = contextsManager.registerContext("myCounter", new Counter(0));

    FunctorSubmitter functorSubmitter = DefaultFunctorSubmitter.getInstance();
    functorSubmitter.submitCommand(contextIdentifier, new LoggingCommand("Commenced", 0));

    for (int i = 0; i &lt; 50; i++) {
      Future&lt;Long&gt; future = functorSubmitter.submitFunctor(contextIdentifier, new NextValueFunctor());
      System.out.println(future.get());
    }

    functorSubmitter.submitCommand(contextIdentifier, new LoggingCommand("Completed", 0));

    Thread.sleep(2000);

    Counter counter = (Counter)contextsManager.getContext(contextIdentifier);
    System.out.println(counter);
  }
}
</code></pre>

<h4>References and Additional Information</h4>

<ul>
<li><p>The <a href="../commandpattern/index.html">Command Pattern</a></p></li>
<li><p>Wikipedia - <a href="http://en.wikipedia.org/wiki/Function_object">Function Objects</a></p></li>
</ul>

                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2019.
          All Rights Reserved.      
                    
      </div>

                                                                  <?xml version="1.0" encoding="UTF-8"?>
<div class="copyright">Copyright © 2008-2013 Oracle Corporation. All rights reserved.</div>
                                                          <?xml version="1.0" encoding="UTF-8"?>
<div class="version">Version 12.6.1: 2019-05-08 18:49</div>
                  
        
                </div>
    </footer>
  </body>
</html>
